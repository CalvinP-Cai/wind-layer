(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{500:function(t,e,r){"use strict";var n,i=r(430),o=r(453),a=r(523),s=r(490),c=r(459),h=r(435),u=r(456),p=r(519),l=r(437),f=r(463),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),v=function(t){function e(e){var r=t.call(this)||this;return r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=e,r}return d(e,t),e.prototype.getFeatures=function(t){return Object(h.b)()},e.prototype.prepareFrame=function(t){return Object(h.b)()},e.prototype.renderFrame=function(t,e){return Object(h.b)()},e.prototype.loadedTileCallback=function(t,e,r){t[e]||(t[e]={}),t[e][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,e,r){return function(n,i){var o=this.loadedTileCallback.bind(this,r,n);return t.forEachLoadedTile(e,n,i,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){},e.prototype.getDataAtPixel=function(t,e,r){return Object(h.b)()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===u.a.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=u.a.LOADED&&e!=u.a.ERROR&&t.addEventListener(l.a.CHANGE,this.boundHandleImageChange_),e==u.a.IDLE&&(t.load(),e=t.getState()),e==u.a.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==f.a.READY&&t.changed()},e}(p.a),m=r(447),y=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),g=function(t){function e(e){var r=t.call(this,e)||this;return r.container=null,r.renderedResolution,r.tempTransform_=Object(m.c)(),r.pixelTransform=Object(m.c)(),r.inversePixelTransform=Object(m.c)(),r.context=null,r.containerReused=!1,r.createTransformStringCanvas_=Object(o.a)(1,1).canvas,r}return y(e,t),e.prototype.useContainer=function(t,e,r){var n,i,a=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===a&&((c=t.firstElementChild)instanceof HTMLCanvasElement&&(i=c.getContext("2d")));if(i&&i.canvas.style.transform===e?(this.container=t,this.context=i,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=a;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var c=(i=Object(o.a)()).canvas;n.appendChild(c),(s=c.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=i}},e.prototype.clip=function(t,e,r){var n=e.pixelRatio,o=e.size[0]*n/2,a=e.size[1]*n/2,s=e.viewState.rotation,h=Object(i.C)(r),u=Object(i.D)(r),p=Object(i.w)(r),l=Object(i.v)(r);Object(m.a)(e.coordinateToPixelTransform,h),Object(m.a)(e.coordinateToPixelTransform,u),Object(m.a)(e.coordinateToPixelTransform,p),Object(m.a)(e.coordinateToPixelTransform,l),t.save(),Object(c.s)(t,-s,o,a),t.beginPath(),t.moveTo(h[0]*n,h[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(p[0]*n,p[1]*n),t.lineTo(l[0]*n,l[1]*n),t.clip(),Object(c.s)(t,s,o,a)},e.prototype.clipUnrotated=function(t,e,r){var n=Object(i.C)(r),o=Object(i.D)(r),a=Object(i.w)(r),s=Object(i.v)(r);Object(m.a)(e.coordinateToPixelTransform,n),Object(m.a)(e.coordinateToPixelTransform,o),Object(m.a)(e.coordinateToPixelTransform,a),Object(m.a)(e.coordinateToPixelTransform,s);var c=this.inversePixelTransform;Object(m.a)(c,n),Object(m.a)(c,o),Object(m.a)(c,a),Object(m.a)(c,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,r){var n=this.getLayer();if(n.hasListener(t)){var i=new a.a(t,this.inversePixelTransform,r,e);n.dispatchEvent(i)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(s.a.PRERENDER,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(s.a.POSTRENDER,t,e)},e.prototype.getRenderTransform=function(t,e,r,n,i,o,a){var s=i/2,c=o/2,h=n/e,u=-h,p=-t[0]+a,l=-t[1];return Object(m.b)(this.tempTransform_,s,c,h,u,-r,p,l)},e.prototype.getDataAtPixel=function(t,e,r){var n,i=Object(m.a)(this.inversePixelTransform,t.slice()),o=this.context;try{n=o.getImageData(Math.round(i[0]),Math.round(i[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},e.prototype.createTransformString=function(t){return this.createTransformStringCanvas_.style.transform=Object(m.i)(t),this.createTransformStringCanvas_.style.transform},e}(v);e.a=g},664:function(t,e,r){"use strict";r.r(e),r.d(e,"Field",(function(){return O})),r.d(e,"WindLayer",(function(){return D}));r(79),r(80),r(147),r(36),r(144),r(12),r(40),r(148),r(149),r(150),r(151),r(39),r(152),r(153),r(154),r(100),r(155),r(78),r(156),r(5),r(189),r(145),r(157),r(158),r(159),r(160),r(161),r(162),r(163),r(164),r(165),r(166),r(167),r(168),r(169),r(170),r(171),r(172),r(173),r(174),r(175),r(176),r(177),r(178),r(179),r(180),r(37);var n=r(30),i=r(503),o=r(444),a=r(500),s=r(447),c=r(430),h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function u(t,e){function r(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}
/*!
 * author: sakitam-fdd <smilefdd@gmail.com> 
 * wind-core v1.0.0-alpha.4
 * build-time: 2020-5-17 15:37
 * LICENSE: MIT
 * (c) 2017-2020 https://github.com/sakitam-fdd/wind-layer#readme
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function l(){for(var t=arguments,e=0,r=0,n=arguments.length;r<n;r++)e+=t[r].length;var i=Array(e),o=0;for(r=0;r<n;r++)for(var a=arguments[r],s=0,c=a.length;s<c;s++,o++)i[o]=a[s];return i}Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){var r=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var o=r[i];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])}return n},writable:!0,configurable:!0});var f=Object.prototype.hasOwnProperty,d="undefined"!=typeof Symbol?Symbol.toStringTag:void 0;function v(t){if(!function(t){var e=Object(n.a)(t);return null!==t&&("object"===e||"function"===e)}(t))return!1;var e=function(t){if(null===t)return void 0===t?"[object Undefined]":"[object Null]";if(!(d&&d in Object(t)))return toString.call(t);var e=f.call(t,d),r=t[d],n=!1;try{t[d]=void 0,n=!0}catch(t){}var i=Object.prototype.toString.call(t);return n&&(e?t[d]=r:delete t[d]),i}(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object Proxy]"===e}function m(t){return"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)}function y(t){for(var e=arguments,r=[],n=1;n<arguments.length;n++)r[n-1]=e[n];return Object.assign.apply(Object,l([t],r))}function g(t){console.warn("wind-layer: "+t)}function x(t){return null!=t&&!isNaN(t)}var b=function(){function t(t,e){this.u=t,this.v=e,this.m=this.magnitude()}return t.prototype.magnitude=function(){return Math.sqrt(this.u*this.u+this.v*this.v)},t.prototype.directionTo=function(){var t=Math.atan2(this.u,this.v)*(180/Math.PI);return t<0&&(t+=360),t},t.prototype.directionFrom=function(){return(this.directionTo()+180)%360},t}(),O=function(){function t(t){this.grid=[],this.xmin=t.xmin,this.xmax=t.xmax,this.ymin=Math.min(t.ymax,t.ymin),this.ymax=Math.max(t.ymax,t.ymin),this.cols=t.cols,this.rows=t.rows,this.us=t.us,this.vs=t.vs,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.isFields=!0;var e=Math.ceil((this.xmax-this.xmin)/t.deltaX),r=Math.ceil((this.ymax-this.ymin)/t.deltaY);e===this.cols&&r===this.rows||console.warn("The data grid not equal"),this.isContinuous=Math.floor(this.cols*t.deltaX)>=360,this.wrappedX="wrappedX"in t?t.wrappedX:this.xmax>180,this.grid=this.buildGrid(),this.range=this.calculateRange()}return t.prototype.buildGrid=function(){for(var t=[],e=0,r=this.rows,n=this.cols,i=this.us,o=this.vs,a=0;a<r;a++){for(var s=[],c=0;c<n;c++,e++){var h=i[e],u=o[e],p=this.isValid(h)&&this.isValid(u);s[c]=p?new b(h,u):null}this.isContinuous&&s.push(s[0]),t[a]=s}return t},t.prototype.release=function(){this.grid=[],this.columns=[]},t.prototype.extent=function(){return[this.xmin,this.ymin,this.xmax,this.ymax]},t.prototype.bilinearInterpolateVector=function(t,e,r,n,i,o){var a=1-t,s=1-e,c=a*s,h=t*s,u=a*e,p=t*e,l=r.u*c+n.u*h+i.u*u+o.u*p,f=r.v*c+n.v*h+i.v*u+o.v*p;return new b(l,f)},t.prototype.calculateRange=function(){if(this.grid&&this.grid[0]){for(var t,e,r=this.grid.length,n=this.grid[0].length,i=0;i<r;i++)for(var o=0;o<n;o++){var a=this.grid[i][o];if(null!==a){var s=a.m||a.magnitude();void 0===t?t=s:void 0===e?(e=s,t=Math.min(t,e),e=Math.max(t,e)):(t=Math.min(s,t),e=Math.max(s,e))}}return[t,e]}},t.prototype.isValid=function(t){return null!=t},t.prototype.getWrappedLongitudes=function(){var t=this.xmin,e=this.xmax;return this.wrappedX&&(this.isContinuous?(t=-180,e=180):(e=this.xmax-360,t=this.xmin-360)),[t,e]},t.prototype.contains=function(t,e){var r=this.getWrappedLongitudes(),n=r[0],i=r[1],o=t>=n&&t<=i,a=e>=this.ymin&&e<=this.ymax;return o&&a},t.prototype.getDecimalIndexes=function(t,e){var r,n;return[((r=t-this.xmin)-(n=360)*Math.floor(r/n))/this.deltaX,(this.ymax-e)/this.deltaY]},t.prototype.valueAt=function(t,e){if(!this.contains(t,e))return null;var r=this.getDecimalIndexes(t,e),n=Math.floor(r[0]),i=Math.floor(r[1]),o=this.clampColumnIndex(n),a=this.clampRowIndex(i);return this.valueAtIndexes(o,a)},t.prototype.interpolatedValueAt=function(t,e){if(!this.contains(t,e))return null;var r=this.getDecimalIndexes(t,e),n=r[0],i=r[1];return this.interpolatePoint(n,i)},t.prototype.hasValueAt=function(t,e){return null!==this.valueAt(t,e)},t.prototype.interpolatePoint=function(t,e){var r=this.getFourSurroundingIndexes(t,e),n=r[0],i=r[1],o=r[2],a=r[3],s=this.getFourSurroundingValues(n,i,o,a);if(s){var c=s[0],h=s[1],u=s[2],p=s[3];return this.bilinearInterpolateVector(t-n,e-o,c,h,u,p)}return null},t.prototype.clampColumnIndex=function(t){var e=t;t<0&&(e=0);var r=this.cols-1;return t>r&&(e=r),e},t.prototype.clampRowIndex=function(t){var e=t;t<0&&(e=0);var r=this.rows-1;return t>r&&(e=r),e},t.prototype.getFourSurroundingIndexes=function(t,e){var r=Math.floor(t),n=r+1;this.isContinuous&&n>=this.cols&&(n=0),n=this.clampColumnIndex(n);var i=this.clampRowIndex(Math.floor(e));return[r,n,i,this.clampRowIndex(i+1)]},t.prototype.getFourSurroundingValues=function(t,e,r,n){var i;if(i=this.grid[r]){var o=i[t],a=i[e];if(this.isValid(o)&&this.isValid(a)&&(i=this.grid[n])){var s=i[t],c=i[e];if(this.isValid(s)&&this.isValid(c))return[o,a,s,c]}}return null},t.prototype.valueAtIndexes=function(t,e){return this.grid[e][t]},t.prototype.lonLatAtIndexes=function(t,e){return[this.longitudeAtX(t),this.latitudeAtY(e)]},t.prototype.longitudeAtX=function(t){var e=this.deltaX/2,r=this.xmin+e+t*this.deltaX;return this.wrappedX&&(r=r>180?r-360:r),r},t.prototype.latitudeAtY=function(t){var e=this.deltaY/2;return this.ymax-e-t*this.deltaY},t.prototype.randomize=function(t,e,r,n){void 0===t&&(t={});var i=Math.random()*(e||this.cols)|0,o=Math.random()*(r||this.rows)|0,a=n([i,o]);return null!==a?(t.x=a[0],t.y=a[1]):(t.x=this.longitudeAtX(i),t.y=this.latitudeAtY(o)),t},t.prototype.checkFields=function(){return this.isFields},t.prototype.startBatchInterpolate=function(t,e,r){},t}();function w(t,e){if(!t)return!1;if(e=e||devicePixelRatio||1,!(t instanceof OffscreenCanvas)){var r=t.clientWidth*e,n=t.clientHeight*e;if(r<=0||n<=0)return!1;if(t.width!==r||t.height!==n)return t.width=r,t.height=n,!0}return!1}function S(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw t.deleteShader(n),new Error(t.getShaderInfoLog(n)||"");return n}var T="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,r=arguments.length;r--;)e+=t[r]*t[r];return Math.sqrt(e)});var j=function(){function t(t,e,r){var n;this.vertShader="",this.fragShader="",e&&(this.vertShader=e),r&&(this.fragShader=r),this.program=function(t,e,r){var n=S(t,t.VERTEX_SHADER,e),i=S(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(null!==o&&(t.attachShader(o,n),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)))throw new Error(t.getProgramInfoLog(o)||"");return o}(t,this.vertShader,this.fragShader),this.gl=t,this.textureUnit=0,this.uniformSetters=this.createUniformSetters(),this.attribSetters=this.createAttributeSetters(),this.transfromStack=[],this.projection=(n=new T(9),T!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n)}return t.prototype.active=function(){return this.gl.useProgram(this.program),this},t.prototype.deactive=function(){return this.gl.deleteProgram(this.program),this},t.prototype.getBindPointForSamplerType=function(t,e){return e===t.SAMPLER_2D?t.TEXTURE_2D:e===t.SAMPLER_CUBE?t.TEXTURE_CUBE_MAP:void 0},t.prototype.createUniformSetter=function(t,e){var r,n,i=this.gl,o=i.getUniformLocation(t,e.name),a=e.type,s=e.size>1&&"[0]"===e.name.substr(-3);if(a===i.FLOAT&&s)return function(t){i.uniform1fv(o,t)};if(a===i.FLOAT)return function(t){i.uniform1f(o,t)};if(a===i.FLOAT_VEC2)return function(t){i.uniform2fv(o,t)};if(a===i.FLOAT_VEC3)return function(t){i.uniform3fv(o,t)};if(a===i.FLOAT_VEC4)return function(t){i.uniform4fv(o,t)};if(a===i.INT&&s)return function(t){i.uniform1iv(o,t)};if(a===i.INT)return function(t){i.uniform1i(o,t)};if(a===i.INT_VEC2)return function(t){i.uniform2iv(o,t)};if(a===i.INT_VEC3)return function(t){i.uniform3iv(o,t)};if(a===i.INT_VEC4)return function(t){i.uniform4iv(o,t)};if(a===i.BOOL)return function(t){i.uniform1iv(o,t)};if(a===i.BOOL_VEC2)return function(t){i.uniform2iv(o,t)};if(a===i.BOOL_VEC3)return function(t){i.uniform3iv(o,t)};if(a===i.BOOL_VEC4)return function(t){i.uniform4iv(o,t)};if(a===i.FLOAT_MAT2)return function(t){i.uniformMatrix2fv(o,!1,t)};if(a===i.FLOAT_MAT3)return function(t){i.uniformMatrix3fv(o,!1,t)};if(a===i.FLOAT_MAT4)return function(t){i.uniformMatrix4fv(o,!1,t)};if((a===i.SAMPLER_2D||a===i.SAMPLER_CUBE)&&s){for(var c=[],h=0;h<e.size;++h)c.push(this.textureUnit++);return function(t,e){return function(r){i.uniform1iv(o,e),r.forEach((function(r,n){i.activeTexture(i.TEXTURE0+e[n]),void 0!==t&&i.bindTexture(t,r)}))}}(this.getBindPointForSamplerType(i,a),c)}if(a===i.SAMPLER_2D||a===i.SAMPLER_CUBE)return r=this.getBindPointForSamplerType(i,a),n=this.textureUnit++,function(t){i.uniform1i(o,n),i.activeTexture(i.TEXTURE0+n),void 0!==r&&i.bindTexture(r,t)};throw"unknown type: 0x"+a.toString(16)},t.prototype.createUniformSetters=function(){var t=this.gl;this.textureUnit=0;var e={};if(null!==this.program)for(var r=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=0;n<r;++n){var i=t.getActiveUniform(this.program,n);if(!i)break;var o=i.name;"[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3));var a=this.createUniformSetter(this.program,i);e[o]=a}return e},t.prototype.createAttribSetter=function(t){var e=this.gl;return function(r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.enableVertexAttribArray(t),void 0===r.numComponents&&void 0===r.size||e.vertexAttribPointer(t,r.numComponents||r.size,r.type||e.FLOAT,r.normalize||!1,r.stride||0,r.offset||0)}},t.prototype.createAttributeSetters=function(){var t=this.gl,e={};if(null!==this.program)for(var r=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=0;n<r;++n){var i=t.getActiveAttrib(this.program,n);if(!i)break;var o=t.getAttribLocation(this.program,i.name);e[i.name]=this.createAttribSetter(o)}return e},t.prototype.setAttributes=function(t,e){return e=e?e.attribSetters||e:this.attribSetters,Object.keys(t).forEach((function(r){var n=e[r];n&&n(t[r])})),this},t.prototype.setUniforms=function(t,e){return e=e?e.uniformSetters||e:this.uniformSetters,Object.keys(t).forEach((function(r){var n=e[r];n&&n(t[r])})),this},t.prototype.clear=function(t){return function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(r,n,i,o),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST)}(this.gl,t),this.transfromStack=[],this},t.prototype.runTimes=function(t){return this.count=t||0,this},t.prototype.updateProjection=function(){var t=this.gl.canvas,e=t.width,r=t.height;return function(t,e,r){t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1}(this.projection,e,r),this},t.prototype.resize=function(t){return w(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),t&&this.updateProjection(),this},t.prototype.draw=function(){throw new Error("should override")},t.prototype.translate=function(){throw new Error("should override")},t.prototype.rotate=function(){throw new Error("should override")},t.prototype.scale=function(){throw new Error("should override")},t}(),_="precision mediump float;\n#define GLSLIFY 1\n\n// 从顶点着色器中传入\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = v_color;\n}\n",A="#define GLSLIFY 1\nattribute vec2 a_position;\nattribute vec4 a_color;\n\n//uniform mat4 u_matrix;\nuniform vec2 u_resolution;\nvarying vec4 v_color;\nuniform float u_pointSize;\n\nvoid main() {\n  // convert the rectangle from pixels to 0.0 to 1.0\n  vec2 zeroToOne = a_position / u_resolution;\n\n  // convert from 0->1 to 0->2\n  vec2 zeroToTwo = zeroToOne * 2.0;\n\n  // convert from 0->2 to -1->+1 (clipspace)\n  vec2 clipSpace = zeroToTwo - 1.0;\n\n  // 未翻转Y轴\n  //  gl_Position = vec4(a_position, 0, 1);\n  // 翻转Y轴\n  gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n  // Multiply the position by the matrix.\n//  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n  // 将颜色传递给片断着色器\n  v_color = a_color;\n\n  gl_PointSize = u_pointSize;\n}\n",P=(function(t){function e(e,r,n){var i=t.call(this,e,r||A,n||_)||this;return i.vertShader=A,i.fragShader=_,i}(function(t,e){function r(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)})(e,t),e.prototype.updateProjection=function(){return this},e.prototype.draw=function(){var t=this.gl.POINTS;return this.gl.drawArrays(t,0,this.count),this},e.prototype.translate=function(){return this},e.prototype.rotate=function(){return this},e.prototype.scale=function(){return this}}(j),{globalAlpha:.9,lineWidth:1,colorScale:"#fff",velocityScale:.04,maxAge:90,paths:800,frameRate:20,minVelocity:0,maxVelocity:10,useCoordsDraw:!0,gpet:!0});function E(t,e,r,n){return Math.max(0,Math.min(n.length-1,Math.round((t-e)/(r-e)*(n.length-1))))}var C=function(){function t(t,e,r){if(this.generated=!1,this.ctx=t,!this.ctx)throw new Error("ctx error");this.animate=this.animate.bind(this),this.setOptions(e),r&&this.updateData(r)}return t.prototype.setOptions=function(t){this.options=Object.assign({},P,t);var e=this.ctx.canvas,r=e.width,n=e.height;"particleAge"in t&&!("maxAge"in t)&&m(this.options.particleAge)&&(this.options.maxAge=this.options.particleAge),"particleMultiplier"in t&&!("paths"in t)&&m(this.options.particleMultiplier)&&(this.options.paths=Math.round(r*n*this.options.particleMultiplier)),this.prerender()},t.prototype.getOptions=function(){return this.options},t.prototype.updateData=function(t){this.field=t},t.prototype.moveParticles=function(){for(var t=this.ctx.canvas,e=t.width,r=t.height,n=this.particles,i=this.options.maxAge,o=v(this.options.velocityScale)?this.options.velocityScale():this.options.velocityScale,a=0,s=n.length;a<s;a++){var c=n[a];c.age>i&&(c.age=0,this.field.randomize(c,e,r,this.unproject));var h=c.x,u=c.y,p=this.field.interpolatedValueAt(h,u);if(null===p)c.age=i;else{var l=h+p.u*o,f=u+p.v*o;this.field.hasValueAt(l,f)?(c.xt=l,c.yt=f,c.m=p.m):(c.x=l,c.y=f,c.age=i)}c.age++}},t.prototype.fadeIn=function(){var t=this.ctx.globalCompositeOperation;this.ctx.globalCompositeOperation="destination-in",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.globalCompositeOperation=t},t.prototype.drawParticles=function(){var t,e=this.particles;this.fadeIn(),this.ctx.globalAlpha=this.options.globalAlpha,this.ctx.fillStyle="rgba(0, 0, 0, "+this.options.globalAlpha+")",this.ctx.lineWidth=m(this.options.lineWidth)?this.options.lineWidth:1,this.ctx.strokeStyle=null!=(t=this.options.colorScale)&&("string"==typeof t||null!==t.constructor&&t.constructor===String)?this.options.colorScale:"#fff";var r=0,n=e.length;if(this.field&&n>0)for(var i=this.field.range,o=i[0],a=i[1];r<n;r++)this[this.options.useCoordsDraw?"drawCoordsParticle":"drawPixelParticle"](e[r],o,a)},t.prototype.drawPixelParticle=function(t,e,r){var n=[t.x,t.y],i=[t.xt,t.yt];if(i&&n&&x(i[0])&&x(i[1])&&x(n[0])&&x(n[1])&&t.age<=this.options.maxAge){if(this.ctx.beginPath(),this.ctx.moveTo(n[0],n[1]),this.ctx.lineTo(i[0],i[1]),v(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(t.m);else if(Array.isArray(this.options.colorScale)){var o=E(t.m,e,r,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[o]}v(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(t.m)),t.x=t.xt,t.y=t.yt,this.ctx.stroke()}},t.prototype.drawCoordsParticle=function(t,e,r){var n=[t.x,t.y],i=[t.xt,t.yt];if(i&&n&&x(i[0])&&x(i[1])&&x(n[0])&&x(n[1])&&this.intersectsCoordinate(i)&&t.age<=this.options.maxAge){var o=this.project(n),a=this.project(i);if(o&&a){if(this.ctx.beginPath(),this.ctx.moveTo(o[0],o[1]),this.ctx.lineTo(a[0],a[1]),t.x=t.xt,t.y=t.yt,v(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(t.m);else if(Array.isArray(this.options.colorScale)){var s=E(t.m,e,r,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[s]}v(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(t.m)),this.ctx.stroke()}}},t.prototype.prepareParticlePaths=function(){var t=this.ctx.canvas,e=t.width,r=t.height,n="function"==typeof this.options.paths?this.options.paths(this):this.options.paths,i=[];if(!this.field)return[];"startBatchInterpolate"in this.field&&this.field.startBatchInterpolate(e,r,this.unproject);for(var o=0;o<n;o++)i.push(this.field.randomize({age:this.randomize()},e,r,this.unproject));return i},t.prototype.randomize=function(){return Math.floor(Math.random()*this.options.maxAge)},t.prototype.project=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];throw new Error("project must be overriden")},t.prototype.unproject=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];throw new Error("unproject must be overriden")},t.prototype.intersectsCoordinate=function(t){throw new Error("must be overriden")},t.prototype.clearCanvas=function(){this.stop(),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.forceStop=!1},t.prototype.start=function(){this.starting=!0,this.forceStop=!1,this._then=Date.now(),this.animate()},t.prototype.stop=function(){cancelAnimationFrame(this.animationLoop),this.starting=!1,this.forceStop=!0},t.prototype.animate=function(){this.animationLoop&&cancelAnimationFrame(this.animationLoop),this.animationLoop=requestAnimationFrame(this.animate);var t=Date.now(),e=t-this._then;e>this.options.frameRate&&(this._then=t-e%this.options.frameRate,this.render())},t.prototype.prerender=function(){this.generated=!1,this.particles=this.prepareParticlePaths(),this.generated=!0,this.starting||this.forceStop||(this.starting=!0,this._then=Date.now(),this.animate())},t.prototype.render=function(){this.moveParticles(),this.drawParticles(),this.postrender()},t.prototype.postrender=function(){},t.Field=O,t}(),R=0,F=1;var M=function(){function t(){this.executors={},this.renderedTransform_=Object(s.c)()}return t.prototype.execute=function(t,e,r,n,i,o,a){if(this.executors[e]){(s=this.executors[e]).project=this.getPixelFromCoordinateInternal.bind(this,r,n),s.unproject=this.getCoordinateFromPixel.bind(this,r),s.intersectsCoordinate=this.intersectsCoordinate.bind(this,r),s.prerender(),s.render()}else{var s=new C(t,o,a);this.executors[e]=s,s.project=this.getPixelFromCoordinateInternal.bind(this,r,n),s.unproject=this.getCoordinateFromPixel.bind(this,r),s.intersectsCoordinate=this.intersectsCoordinate.bind(this,r),s.postrender=function(){},s.prerender()}},t.prototype.setOptions=function(t){var e=this;Object.keys(this.executors).forEach((function(r){var n=e.executors[r];n&&n.setOptions(t)}))},t.prototype.repeatWorld=function(t,e,r){var n;return e&&function(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}(r,this.renderedTransform_)?n=e:(e||(e=[]),n=function(t,e,r,n,i,o){for(var a=o||[],s=0,c=e;c<r;c+=n){var h=t[c],u=t[c+1];a[s++]=i[0]*h+i[2]*u+i[4],a[s++]=i[1]*h+i[3]*u+i[5]}return o&&a.length!=s&&(a.length=s),a}(t,0,t.length,2,r,e),Object(s.h)(this.renderedTransform_,r)),n},t.prototype.getPixelFromCoordinateInternal=function(t,e,r){var n=t.viewState,i=t.pixelRatio,a=Object(o.transform)(r,"EPSG:4326",n.projection),c=Object(o.fromUserCoordinate)(a,n.projection);if(t){var h=Object(s.a)(t.coordinateToPixelTransform,c.slice(0,2)),u=this.repeatWorld(c.slice(0,2),h,e);return[u[0]*i,u[1]*i]}return null},t.prototype.getCoordinateFromPixel=function(t,e){var r=t.viewState;if(t){var n=Object(s.a)(t.pixelToCoordinateTransform,e.slice(0,2)),i=Object(o.toUserCoordinate)(n,r.projection),a=Object(o.transform)(i,r.projection,"EPSG:4326");return[a[0],a[1]]}return null},t.prototype.intersectsCoordinate=function(t,e){var r=t.viewState,n=Object(o.transform)(e,"EPSG:4326",r.projection),i=Object(o.fromUserCoordinate)(n,r.projection);return Object(c.f)(t.extent,i.slice(0,2))},t}(),I=function(t){function e(e){var r=t.call(this,e)||this;return r.oRender=new M,r}return u(e,t),e.prototype.useContainer=function(e,r,n){t.prototype.useContainer.call(this,null,r,n)},e.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],r=t.viewState,n=t.viewHints,i=t.extent;return void 0!==e.extent&&(i=Object(c.B)(i,Object(o.fromUserExtent)(e.extent,r.projection))),!(n[R]||t.animate||n[F]||Object(c.H)(i))||this.getLayer().get("forceRender")},e.prototype.renderFrame=function(t,e){var r=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,i=t.viewState,a=i.projection,h=t.size,u=Math.round(h[0]*n),p=Math.round(h[1]*n);Object(s.e)(this.pixelTransform,1/n,1/n),Object(s.d)(this.inversePixelTransform,this.pixelTransform);var l=Object(s.i)(this.pixelTransform);this.useContainer(e,l,r.opacity);var f=this.context,d=f.canvas;d.width!=u||d.height!=p?(d.width=u,d.height=p,d.style.transform!==l&&(d.style.transform=l)):this.containerReused||f.clearRect(0,0,u,p),this.preRender(f,t);var v=!1;if(r.extent){var m=Object(o.fromUserExtent)(r.extent,i.projection);(v=!Object(c.g)(m,t.extent)&&Object(c.F)(m,t.extent))&&this.clipUnrotated(f,t,m)}t.extent;var y=i.center,g=i.resolution,x=i.rotation,b=(a.getExtent(),this.getLayer()),O=b.getWindOptions(),w=b.getData(),S=this.getRenderTransform(y,g,x,n,u,p,0);this.oRender.execute(this.context,0,t,S,S,O,w),v&&f.restore(),this.postRender(f,t);var T=r.opacity,j=this.container;return null!==j&&T!==parseFloat(j.style.opacity)&&(j.style.opacity=1===T?"":T),this.container},e}(a.a),L={forceRender:!0,windOptions:{}},D=function(t){function e(e,r){var n=this,i=y({},L,r);return(n=t.call(this,i)||this).field=null,n.options=i,n.pickWindOptions(),n._map=i.map||null,e&&n.setData(e),n}return u(e,t),e.prototype.render=function(t,e){var r=this.getRenderer();if(r.prepareFrame(t))return r.renderFrame(t,e)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.getWrapX=function(){return this.get("wrapX")},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return new I(this)},e.prototype.pickWindOptions=function(){var t=this;Object.keys(P).forEach((function(e){e in t.options&&(void 0===t.options.windOptions&&(t.options.windOptions={}),t.options.windOptions[e]=t.options[e])}))},e.prototype.getData=function(){return this.field},e.prototype.setData=function(t){var e;return t&&t.checkFields&&t.checkFields()?this.field=t:(e=t,Array.isArray(e)?this.field=function(t){var e,r;if(console.time("format-data"),t.forEach((function(t){switch(t.header.parameterCategory+","+t.header.parameterNumber){case"1,2":case"2,2":e=t;break;case"1,3":case"2,3":r=t}})),r&&e){var n=e.header,i=new O({xmin:n.lo1,ymin:n.la2,xmax:n.lo2,ymax:n.la1,deltaX:n.dx,deltaY:n.dy,cols:n.nx,rows:n.ny,us:e.data,vs:r.data});return console.timeEnd("format-data"),i}}(t):console.error("Illegal data")),this},e.prototype.updateParams=function(t){return void 0===t&&(t={}),g("will move to setWindOptions"),this.setWindOptions(t),this},e.prototype.getParams=function(){return g("will move to getWindOptions"),this.getWindOptions()},e.prototype.setWindOptions=function(t){var e=this.options.windOptions||{};this.options=y(this.options,{windOptions:y(e,t||{})});var r=this.getRenderer();if(r&&r.oRender){var n=this.options.windOptions;r.oRender.setOptions(n)}},e.prototype.getWindOptions=function(){return this.options.windOptions||{}},e}(i.a)}}]);