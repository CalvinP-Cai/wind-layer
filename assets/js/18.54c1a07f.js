(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{484:function(t,e,n){"use strict";e.a={ANIMATING:0,INTERACTING:1}},500:function(t,e,n){"use strict";var i,r=n(430),o=n(453),a=n(523),s=n(490),c=n(459),h=n(435),u=n(456),p=n(519),l=n(437),f=n(463),d=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t){function e(e){var n=t.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=e,n}return d(e,t),e.prototype.getFeatures=function(t){return Object(h.b)()},e.prototype.prepareFrame=function(t){return Object(h.b)()},e.prototype.renderFrame=function(t,e){return Object(h.b)()},e.prototype.loadedTileCallback=function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n},e.prototype.createLoadedTileFinder=function(t,e,n){return function(i,r){var o=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,r,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){},e.prototype.getDataAtPixel=function(t,e,n){return Object(h.b)()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===u.a.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=u.a.LOADED&&e!=u.a.ERROR&&t.addEventListener(l.a.CHANGE,this.boundHandleImageChange_),e==u.a.IDLE&&(t.load(),e=t.getState()),e==u.a.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==f.a.READY&&t.changed()},e}(p.a),g=n(447),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),m=function(t){function e(e){var n=t.call(this,e)||this;return n.container=null,n.renderedResolution,n.tempTransform_=Object(g.c)(),n.pixelTransform=Object(g.c)(),n.inversePixelTransform=Object(g.c)(),n.context=null,n.containerReused=!1,n.createTransformStringCanvas_=Object(o.a)(1,1).canvas,n}return y(e,t),e.prototype.useContainer=function(t,e,n){var i,r,a=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===a&&((c=t.firstElementChild)instanceof HTMLCanvasElement&&(r=c.getContext("2d")));if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(i=document.createElement("div")).className=a;var s=i.style;s.position="absolute",s.width="100%",s.height="100%";var c=(r=Object(o.a)()).canvas;i.appendChild(c),(s=c.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=i,this.context=r}},e.prototype.clip=function(t,e,n){var i=e.pixelRatio,o=e.size[0]*i/2,a=e.size[1]*i/2,s=e.viewState.rotation,h=Object(r.C)(n),u=Object(r.D)(n),p=Object(r.w)(n),l=Object(r.v)(n);Object(g.a)(e.coordinateToPixelTransform,h),Object(g.a)(e.coordinateToPixelTransform,u),Object(g.a)(e.coordinateToPixelTransform,p),Object(g.a)(e.coordinateToPixelTransform,l),t.save(),Object(c.s)(t,-s,o,a),t.beginPath(),t.moveTo(h[0]*i,h[1]*i),t.lineTo(u[0]*i,u[1]*i),t.lineTo(p[0]*i,p[1]*i),t.lineTo(l[0]*i,l[1]*i),t.clip(),Object(c.s)(t,s,o,a)},e.prototype.clipUnrotated=function(t,e,n){var i=Object(r.C)(n),o=Object(r.D)(n),a=Object(r.w)(n),s=Object(r.v)(n);Object(g.a)(e.coordinateToPixelTransform,i),Object(g.a)(e.coordinateToPixelTransform,o),Object(g.a)(e.coordinateToPixelTransform,a),Object(g.a)(e.coordinateToPixelTransform,s);var c=this.inversePixelTransform;Object(g.a)(c,i),Object(g.a)(c,o),Object(g.a)(c,a),Object(g.a)(c,s),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,n){var i=this.getLayer();if(i.hasListener(t)){var r=new a.a(t,this.inversePixelTransform,n,e);i.dispatchEvent(r)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(s.a.PRERENDER,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(s.a.POSTRENDER,t,e)},e.prototype.getRenderTransform=function(t,e,n,i,r,o,a){var s=r/2,c=o/2,h=i/e,u=-h,p=-t[0]+a,l=-t[1];return Object(g.b)(this.tempTransform_,s,c,h,u,-n,p,l)},e.prototype.getDataAtPixel=function(t,e,n){var i,r=Object(g.a)(this.inversePixelTransform,t.slice()),o=this.context;try{i=o.getImageData(Math.round(r[0]),Math.round(r[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:i}return 0===i[3]?null:i},e.prototype.createTransformString=function(t){return this.createTransformStringCanvas_.style.transform=Object(g.i)(t),this.createTransformStringCanvas_.style.transform},e}(v);e.a=m},677:function(t,e,n){"use strict";n.r(e);n(79),n(80),n(147),n(36),n(144),n(12),n(40),n(148),n(149),n(150),n(151),n(39),n(152),n(153),n(154),n(100),n(155),n(78),n(156),n(5),n(145),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(37);var i,r=n(30),o=n(430),a=n(503),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e){var n=e||{};return t.call(this,n)||this}return s(e,t),e}(a.a),h=n(526),u=n(484),p=n(444),l=n(500),f=n(447),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),v=function(t){function e(e){var n=t.call(this,e)||this;return n.image_=null,n}return d(e,t),e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,i=t.viewState,r=i.resolution,a=this.getLayer().getSource(),s=t.viewHints,c=t.extent;if(void 0!==e.extent&&(c=Object(o.B)(c,Object(p.fromUserExtent)(e.extent,i.projection))),!s[u.a.ANIMATING]&&!s[u.a.INTERACTING]&&!Object(o.H)(c)){var l=i.projection;if(!h.a){var f=a.getProjection();f&&(l=f)}var d=a.getImage(c,r,n,l);d&&this.loadImage(d)&&(this.image_=d)}return!!this.image_},e.prototype.renderFrame=function(t,e){var n=this.image_,i=n.getExtent(),r=n.getResolution(),a=n.getPixelRatio(),s=t.layerStatesArray[t.layerIndex],c=t.pixelRatio,h=t.viewState,u=h.center,l=h.resolution,d=t.size,v=c*r/(l*a),g=Math.round(d[0]*c),y=Math.round(d[1]*c),m=h.rotation;if(m){var _=Math.round(Math.sqrt(g*g+y*y));g=_,y=_}Object(f.b)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/c,1/c,m,-g/2,-y/2),Object(f.d)(this.inversePixelTransform,this.pixelTransform);var x=this.createTransformString(this.pixelTransform);this.useContainer(e,x,s.opacity);var O=this.context,b=O.canvas;b.width!=g||b.height!=y?(b.width=g,b.height=y):this.containerReused||O.clearRect(0,0,g,y);var w=!1;if(s.extent){var j=Object(p.fromUserExtent)(s.extent,h.projection);(w=!Object(o.g)(j,t.extent)&&Object(o.F)(j,t.extent))&&this.clipUnrotated(O,t,j)}var A=n.getImage(),P=Object(f.b)(this.tempTransform_,g/2,y/2,v,v,0,a*(i[0]-u[0])/r,a*(u[1]-i[3])/r);this.renderedResolution=r*c/a;var S=P[4],E=P[5],T=A.width*P[0],I=A.height*P[3];if(this.preRender(O,t),T>=.5&&I>=.5){var R=s.opacity,C=void 0;1!==R&&(C=this.context.globalAlpha,this.context.globalAlpha=R),this.context.drawImage(A,0,0,+A.width,+A.height,Math.round(S),Math.round(E),Math.round(T),Math.round(I)),1!==R&&(this.context.globalAlpha=C)}return this.postRender(O,t),w&&O.restore(),x!==b.style.transform&&(b.style.transform=x),this.container},e}(l.a),g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),y=function(t){function e(e){return t.call(this,e)||this}return g(e,t),e.prototype.createRenderer=function(){return new v(this)},e}(c),m=n(525),_=n(456),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),O=function(t){function e(e,n,i,r,o){var a=this,s=void 0!==o?_.a.IDLE:_.a.LOADED;return(a=t.call(this,e,n,i,s)||this).loader_=void 0!==o?o:null,a.canvas_=r,a.error_=null,a}return x(e,t),e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=_.a.ERROR):this.state=_.a.LOADED,this.changed()},e.prototype.load=function(){this.state==_.a.IDLE&&(this.state=_.a.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(m.a),b=n(435),w=n(440),j=n(471),A=n(458),P=n(437),S=n(591),E=n(592),T=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),I=function(t){function e(e,n,i,r,a,s){var c=this,u=e.getExtent(),p=n.getExtent(),l=p?Object(o.B)(i,p):i,f=Object(o.x)(l),d=Object(S.a)(e,n,f,r),v=h.b,g=new E.a(e,n,l,u,d*v),y=s(g.calculateSourceExtent(),d,a),m=y?_.a.IDLE:_.a.EMPTY,x=y?y.getPixelRatio():1;return(c=t.call(this,i,r,x,m)||this).targetProj_=n,c.maxSourceExtent_=u,c.triangulation_=g,c.targetResolution_=r,c.targetExtent_=i,c.sourceImage_=y,c.sourcePixelRatio_=x,c.canvas_=null,c.sourceListenerKey_=null,c}return T(e,t),e.prototype.disposeInternal=function(){this.state==_.a.LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==_.a.LOADED){var e=Object(o.E)(this.targetExtent_)/this.targetResolution_,n=Object(o.A)(this.targetExtent_)/this.targetResolution_;this.canvas_=Object(S.b)(e,n,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==_.a.IDLE){this.state=_.a.LOADING,this.changed();var t=this.sourceImage_.getState();t==_.a.LOADED||t==_.a.ERROR?this.reproject_():(this.sourceListenerKey_=Object(A.a)(this.sourceImage_,P.a.CHANGE,(function(t){var e=this.sourceImage_.getState();e!=_.a.LOADED&&e!=_.a.ERROR||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){Object(A.c)(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(m.a),R=n(537),C=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),M="imageloadstart",L="imageloadend",F="imageloaderror",D=function(t){function e(e,n){var i=t.call(this,e)||this;return i.image=n,i}return C(e,t),e}(j.a);var N=function(t){function e(e){var n=t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state})||this;return n.resolutions_=void 0!==e.resolutions?e.resolutions:null,n.reprojectedImage_=null,n.reprojectedRevision_=0,n}return C(e,t),e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Object(w.e)(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,n,i){var r=this.getProjection();if(h.a&&r&&i&&!Object(p.equivalent)(r,i)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Object(p.equivalent)(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&Object(o.p)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new I(r,i,t,e,n,function(t,e,n){return this.getImageInternal(t,e,n,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(i=r),this.getImageInternal(t,e,n,i)},e.prototype.getImageInternal=function(t,e,n,i){return Object(b.b)()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case _.a.LOADING:this.loading=!0,this.dispatchEvent(new D(M,e));break;case _.a.LOADED:this.loading=!1,this.dispatchEvent(new D(L,e));break;case _.a.ERROR:this.loading=!1,this.dispatchEvent(new D(F,e))}},e}(R.a),V=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),W=function(t){function e(e){var n=this,i=e||{};return(n=t.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions,state:i.state})||this).canvasFunction_=i.canvasFunction,n.canvas_=null,n.renderedRevision_=0,n.ratio_=void 0!==i.ratio?i.ratio:1.5,n}return V(e,t),e.prototype.getImageInternal=function(t,e,n,i){e=this.findNearestResolution(e);var r=this.canvas_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==n&&Object(o.g)(r.getExtent(),t))return r;t=t.slice(),Object(o.J)(t,this.ratio_);var a=[Object(o.E)(t)/e*n,Object(o.A)(t)/e*n],s=this.canvasFunction_.call(this,t,e,n,a,i);return s&&(r=new O(t,e,n,s)),this.canvas_=r,this.renderedRevision_=this.getRevision(),r},e}(N);n.d(e,"Field",(function(){return et})),n.d(e,"PerfWindLayer",(function(){return vt})),n.d(e,"WindLayer",(function(){return mt})),n.d(e,"WindLayerRender",(function(){return ft}));
/*!
 * author: sakitam-fdd <smilefdd@gmail.com> 
 * ol5-wind v1.0.0-alpha.3
 * build-time: 2020-5-17 15:6
 * LICENSE: MIT
 * (c) 2017-2020 https://github.com/sakitam-fdd/wind-layer#readme
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var k=function(t,e){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function U(t,e){function n(){this.constructor=t}k(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}
/*!
 * author: sakitam-fdd <smilefdd@gmail.com> 
 * wind-core v1.0.0-alpha.3
 * build-time: 2020-5-17 15:8
 * LICENSE: MIT
 * (c) 2017-2020 https://github.com/sakitam-fdd/wind-layer#readme
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var z=function(t,e){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function B(){for(var t=arguments,e=0,n=0,i=arguments.length;n<i;n++)e+=t[n].length;var r=Array(e),o=0;for(n=0;n<i;n++)for(var a=arguments[n],s=0,c=a.length;s<c;s++,o++)r[o]=a[s];return r}Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){var n=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),r=1;r<arguments.length;r++){var o=n[r];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(i[a]=o[a])}return i},writable:!0,configurable:!0});var G=Object.prototype.hasOwnProperty,X="undefined"!=typeof Symbol?Symbol.toStringTag:void 0;function Y(t){if(!function(t){var e=Object(r.a)(t);return null!==t&&("object"===e||"function"===e)}(t))return!1;var e=function(t){if(null===t)return void 0===t?"[object Undefined]":"[object Null]";if(!(X&&X in Object(t)))return toString.call(t);var e=G.call(t,X),n=t[X],i=!1;try{t[X]=void 0,i=!0}catch(t){}var r=Object.prototype.toString.call(t);return i&&(e?t[X]=n:delete t[X]),r}(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object Proxy]"===e}function H(t){return"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)}function q(t){return Array.isArray(t)}function K(t){for(var e=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=e[i];return Object.assign.apply(Object,B([t],n))}function J(t){console.warn("wind-layer: "+t)}function Q(t){return null!=t&&!isNaN(t)}function Z(t){var e,n;if(t.forEach((function(t){switch(t.header.parameterCategory+","+t.header.parameterNumber){case"1,2":case"2,2":e=t;break;case"1,3":case"2,3":n=t}})),n&&e){var i=e.header;return new et({xmin:i.lo1,ymin:i.la2,xmax:i.lo2,ymax:i.la1,deltaX:i.dx,deltaY:i.dy,cols:i.nx,rows:i.ny,us:e.data,vs:n.data})}}function $(t,e,n,i){if("undefined"!=typeof document){var r=document.createElement("canvas");return r.width=t*n,r.height=e*n,r}return new i(t*n,e*n)}var tt=function(){function t(t,e){this.u=t,this.v=e,this.m=this.magnitude()}return t.prototype.magnitude=function(){return Math.sqrt(this.u*this.u+this.v*this.v)},t.prototype.directionTo=function(){var t=Math.atan2(this.u,this.v)*(180/Math.PI);return t<0&&(t+=360),t},t.prototype.directionFrom=function(){return(this.directionTo()+180)%360},t}(),et=function(){function t(t){this.grid=[],this.xmin=t.xmin,this.xmax=t.xmax,this.ymin=Math.min(t.ymax,t.ymin),this.ymax=Math.max(t.ymax,t.ymin),this.cols=t.cols,this.rows=t.rows,this.us=t.us,this.vs=t.vs,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.isFields=!0;var e=Math.ceil((this.xmax-this.xmin)/t.deltaX),n=Math.ceil((this.ymax-this.ymin)/t.deltaY);e===this.cols&&n===this.rows||console.warn("The data grid not equal"),this.isContinuous=Math.floor(this.cols*t.deltaX)>=360,this.wrappedX="wrappedX"in t?t.wrappedX:this.xmax>180,this.grid=this.buildGrid(),this.range=this.calculateRange()}return t.prototype.buildGrid=function(){for(var t=[],e=0,n=this.rows,i=this.cols,r=this.us,o=this.vs,a=0;a<n;a++){for(var s=[],c=0;c<i;c++,e++){var h=r[e],u=o[e],p=this.isValid(h)&&this.isValid(u);s[c]=p?new tt(h,u):null}this.isContinuous&&s.push(s[0]),t[a]=s}return t},t.prototype.release=function(){this.grid=[],this.columns=[]},t.prototype.extent=function(){return[this.xmin,this.ymin,this.xmax,this.ymax]},t.prototype.bilinearInterpolateVector=function(t,e,n,i,r,o){var a=1-t,s=1-e,c=a*s,h=t*s,u=a*e,p=t*e,l=n.u*c+i.u*h+r.u*u+o.u*p,f=n.v*c+i.v*h+r.v*u+o.v*p;return new tt(l,f)},t.prototype.calculateRange=function(){if(this.grid&&this.grid[0]){for(var t,e,n=this.grid.length,i=this.grid[0].length,r=0;r<n;r++)for(var o=0;o<i;o++){var a=this.grid[r][o];if(null!==a){var s=a.m||a.magnitude();void 0===t?t=s:void 0===e?(e=s,t=Math.min(t,e),e=Math.max(t,e)):(t=Math.min(s,t),e=Math.max(s,e))}}return[t,e]}},t.prototype.isValid=function(t){return null!=t},t.prototype.getWrappedLongitudes=function(){var t=this.xmin,e=this.xmax;return this.wrappedX&&(this.isContinuous?(t=-180,e=180):(e=this.xmax-360,t=this.xmin-360)),[t,e]},t.prototype.contains=function(t,e){var n=this.getWrappedLongitudes(),i=n[0],r=n[1],o=t>=i&&t<=r,a=e>=this.ymin&&e<=this.ymax;return o&&a},t.prototype.getDecimalIndexes=function(t,e){var n,i;return[((n=t-this.xmin)-(i=360)*Math.floor(n/i))/this.deltaX,(this.ymax-e)/this.deltaY]},t.prototype.valueAt=function(t,e){if(!this.contains(t,e))return null;var n=this.getDecimalIndexes(t,e),i=Math.floor(n[0]),r=Math.floor(n[1]),o=this.clampColumnIndex(i),a=this.clampRowIndex(r);return this.valueAtIndexes(o,a)},t.prototype.interpolatedValueAt=function(t,e){if(!this.contains(t,e))return null;var n=this.getDecimalIndexes(t,e),i=n[0],r=n[1];return this.interpolatePoint(i,r)},t.prototype.hasValueAt=function(t,e){return null!==this.valueAt(t,e)},t.prototype.interpolatePoint=function(t,e){var n=this.getFourSurroundingIndexes(t,e),i=n[0],r=n[1],o=n[2],a=n[3],s=this.getFourSurroundingValues(i,r,o,a);if(s){var c=s[0],h=s[1],u=s[2],p=s[3];return this.bilinearInterpolateVector(t-i,e-o,c,h,u,p)}return null},t.prototype.clampColumnIndex=function(t){var e=t;t<0&&(e=0);var n=this.cols-1;return t>n&&(e=n),e},t.prototype.clampRowIndex=function(t){var e=t;t<0&&(e=0);var n=this.rows-1;return t>n&&(e=n),e},t.prototype.getFourSurroundingIndexes=function(t,e){var n=Math.floor(t),i=n+1;this.isContinuous&&i>=this.cols&&(i=0),i=this.clampColumnIndex(i);var r=this.clampRowIndex(Math.floor(e));return[n,i,r,this.clampRowIndex(r+1)]},t.prototype.getFourSurroundingValues=function(t,e,n,i){var r;if(r=this.grid[n]){var o=r[t],a=r[e];if(this.isValid(o)&&this.isValid(a)&&(r=this.grid[i])){var s=r[t],c=r[e];if(this.isValid(s)&&this.isValid(c))return[o,a,s,c]}}return null},t.prototype.valueAtIndexes=function(t,e){return this.grid[e][t]},t.prototype.lonLatAtIndexes=function(t,e){return[this.longitudeAtX(t),this.latitudeAtY(e)]},t.prototype.longitudeAtX=function(t){var e=this.deltaX/2,n=this.xmin+e+t*this.deltaX;return this.wrappedX&&(n=n>180?n-360:n),n},t.prototype.latitudeAtY=function(t){var e=this.deltaY/2;return this.ymax-e-t*this.deltaY},t.prototype.randomize=function(t,e,n,i){void 0===t&&(t={});var r=Math.random()*(e||this.cols)|0,o=Math.random()*(n||this.rows)|0,a=i([r,o]);return null!==a?(t.x=a[0],t.y=a[1]):(t.x=this.longitudeAtX(r),t.y=this.latitudeAtY(o)),t},t.prototype.checkFields=function(){return this.isFields},t.prototype.startBatchInterpolate=function(t,e,n){},t}();function nt(t,e){if(!t)return!1;if(e=e||devicePixelRatio||1,!(t instanceof OffscreenCanvas)){var n=t.clientWidth*e,i=t.clientHeight*e;if(n<=0||i<=0)return!1;if(t.width!==n||t.height!==i)return t.width=n,t.height=i,!0}return!1}function it(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw t.deleteShader(i),new Error(t.getShaderInfoLog(i)||"");return i}var rt="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,n=arguments.length;n--;)e+=t[n]*t[n];return Math.sqrt(e)});var ot=function(){function t(t,e,n){var i;this.vertShader="",this.fragShader="",e&&(this.vertShader=e),n&&(this.fragShader=n),this.program=function(t,e,n){var i=it(t,t.VERTEX_SHADER,e),r=it(t,t.FRAGMENT_SHADER,n),o=t.createProgram();if(null!==o&&(t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)))throw new Error(t.getProgramInfoLog(o)||"");return o}(t,this.vertShader,this.fragShader),this.gl=t,this.textureUnit=0,this.uniformSetters=this.createUniformSetters(),this.attribSetters=this.createAttributeSetters(),this.transfromStack=[],this.projection=(i=new rt(9),rt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i)}return t.prototype.active=function(){return this.gl.useProgram(this.program),this},t.prototype.deactive=function(){return this.gl.deleteProgram(this.program),this},t.prototype.getBindPointForSamplerType=function(t,e){return e===t.SAMPLER_2D?t.TEXTURE_2D:e===t.SAMPLER_CUBE?t.TEXTURE_CUBE_MAP:void 0},t.prototype.createUniformSetter=function(t,e){var n,i,r=this.gl,o=r.getUniformLocation(t,e.name),a=e.type,s=e.size>1&&"[0]"===e.name.substr(-3);if(a===r.FLOAT&&s)return function(t){r.uniform1fv(o,t)};if(a===r.FLOAT)return function(t){r.uniform1f(o,t)};if(a===r.FLOAT_VEC2)return function(t){r.uniform2fv(o,t)};if(a===r.FLOAT_VEC3)return function(t){r.uniform3fv(o,t)};if(a===r.FLOAT_VEC4)return function(t){r.uniform4fv(o,t)};if(a===r.INT&&s)return function(t){r.uniform1iv(o,t)};if(a===r.INT)return function(t){r.uniform1i(o,t)};if(a===r.INT_VEC2)return function(t){r.uniform2iv(o,t)};if(a===r.INT_VEC3)return function(t){r.uniform3iv(o,t)};if(a===r.INT_VEC4)return function(t){r.uniform4iv(o,t)};if(a===r.BOOL)return function(t){r.uniform1iv(o,t)};if(a===r.BOOL_VEC2)return function(t){r.uniform2iv(o,t)};if(a===r.BOOL_VEC3)return function(t){r.uniform3iv(o,t)};if(a===r.BOOL_VEC4)return function(t){r.uniform4iv(o,t)};if(a===r.FLOAT_MAT2)return function(t){r.uniformMatrix2fv(o,!1,t)};if(a===r.FLOAT_MAT3)return function(t){r.uniformMatrix3fv(o,!1,t)};if(a===r.FLOAT_MAT4)return function(t){r.uniformMatrix4fv(o,!1,t)};if((a===r.SAMPLER_2D||a===r.SAMPLER_CUBE)&&s){for(var c=[],h=0;h<e.size;++h)c.push(this.textureUnit++);return function(t,e){return function(n){r.uniform1iv(o,e),n.forEach((function(n,i){r.activeTexture(r.TEXTURE0+e[i]),void 0!==t&&r.bindTexture(t,n)}))}}(this.getBindPointForSamplerType(r,a),c)}if(a===r.SAMPLER_2D||a===r.SAMPLER_CUBE)return n=this.getBindPointForSamplerType(r,a),i=this.textureUnit++,function(t){r.uniform1i(o,i),r.activeTexture(r.TEXTURE0+i),void 0!==n&&r.bindTexture(n,t)};throw"unknown type: 0x"+a.toString(16)},t.prototype.createUniformSetters=function(){var t=this.gl;this.textureUnit=0;var e={};if(null!==this.program)for(var n=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),i=0;i<n;++i){var r=t.getActiveUniform(this.program,i);if(!r)break;var o=r.name;"[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3));var a=this.createUniformSetter(this.program,r);e[o]=a}return e},t.prototype.createAttribSetter=function(t){var e=this.gl;return function(n){e.bindBuffer(e.ARRAY_BUFFER,n.buffer),e.enableVertexAttribArray(t),void 0===n.numComponents&&void 0===n.size||e.vertexAttribPointer(t,n.numComponents||n.size,n.type||e.FLOAT,n.normalize||!1,n.stride||0,n.offset||0)}},t.prototype.createAttributeSetters=function(){var t=this.gl,e={};if(null!==this.program)for(var n=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),i=0;i<n;++i){var r=t.getActiveAttrib(this.program,i);if(!r)break;var o=t.getAttribLocation(this.program,r.name);e[r.name]=this.createAttribSetter(o)}return e},t.prototype.setAttributes=function(t,e){return e=e?e.attribSetters||e:this.attribSetters,Object.keys(t).forEach((function(n){var i=e[n];i&&i(t[n])})),this},t.prototype.setUniforms=function(t,e){return e=e?e.uniformSetters||e:this.uniformSetters,Object.keys(t).forEach((function(n){var i=e[n];i&&i(t[n])})),this},t.prototype.clear=function(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3];t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(n,i,r,o),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST)}(this.gl,t),this.transfromStack=[],this},t.prototype.runTimes=function(t){return this.count=t||0,this},t.prototype.updateProjection=function(){var t=this.gl.canvas,e=t.width,n=t.height;return function(t,e,n){t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1}(this.projection,e,n),this},t.prototype.resize=function(t){return nt(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),t&&this.updateProjection(),this},t.prototype.draw=function(){throw new Error("should override")},t.prototype.translate=function(){throw new Error("should override")},t.prototype.rotate=function(){throw new Error("should override")},t.prototype.scale=function(){throw new Error("should override")},t}(),at="precision mediump float;\n#define GLSLIFY 1\n\n// 从顶点着色器中传入\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = v_color;\n}\n",st="#define GLSLIFY 1\nattribute vec2 a_position;\nattribute vec4 a_color;\n\n//uniform mat4 u_matrix;\nuniform vec2 u_resolution;\nvarying vec4 v_color;\nuniform float u_pointSize;\n\nvoid main() {\n  // convert the rectangle from pixels to 0.0 to 1.0\n  vec2 zeroToOne = a_position / u_resolution;\n\n  // convert from 0->1 to 0->2\n  vec2 zeroToTwo = zeroToOne * 2.0;\n\n  // convert from 0->2 to -1->+1 (clipspace)\n  vec2 clipSpace = zeroToTwo - 1.0;\n\n  // 未翻转Y轴\n  //  gl_Position = vec4(a_position, 0, 1);\n  // 翻转Y轴\n  gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n  // Multiply the position by the matrix.\n//  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n  // 将颜色传递给片断着色器\n  v_color = a_color;\n\n  gl_PointSize = u_pointSize;\n}\n",ct=(function(t){function e(e,n,i){var r=t.call(this,e,n||st,i||at)||this;return r.vertShader=st,r.fragShader=at,r}(function(t,e){function n(){this.constructor=t}z(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.updateProjection=function(){return this},e.prototype.draw=function(){var t=this.gl.POINTS;return this.gl.drawArrays(t,0,this.count),this},e.prototype.translate=function(){return this},e.prototype.rotate=function(){return this},e.prototype.scale=function(){return this}}(ot),{globalAlpha:.9,lineWidth:1,colorScale:"#fff",velocityScale:.04,maxAge:90,paths:800,frameRate:20,minVelocity:0,maxVelocity:10,useCoordsDraw:!0,gpet:!0});function ht(t,e,n,i){return Math.max(0,Math.min(i.length-1,Math.round((t-e)/(n-e)*(i.length-1))))}var ut=function(){function t(t,e,n){if(this.generated=!1,this.ctx=t,!this.ctx)throw new Error("ctx error");this.setOptions(e),this.animate=this.animate.bind(this),n&&this.updateData(n)}return t.prototype.setOptions=function(t){this.options=Object.assign({},ct,t);var e=this.ctx.canvas,n=e.width,i=e.height;"particleAge"in t&&!("maxAge"in t)&&H(this.options.particleAge)&&(this.options.maxAge=this.options.particleAge),"particleMultiplier"in t&&!("paths"in t)&&H(this.options.particleMultiplier)&&(this.options.paths=Math.round(n*i*this.options.particleMultiplier)),this.prerender()},t.prototype.getOptions=function(){return this.options},t.prototype.updateData=function(t){this.field=t},t.prototype.moveParticles=function(){for(var t=this.ctx.canvas,e=t.width,n=t.height,i=this.particles,r=this.options.maxAge,o=Y(this.options.velocityScale)?this.options.velocityScale():this.options.velocityScale,a=0,s=i.length;a<s;a++){var c=i[a];c.age>r&&(c.age=0,this.field.randomize(c,e,n,this.unproject));var h=c.x,u=c.y,p=this.field.interpolatedValueAt(h,u);if(null===p)c.age=r;else{var l=h+p.u*o,f=u+p.v*o;this.field.hasValueAt(l,f)?(c.xt=l,c.yt=f,c.m=p.m):(c.x=l,c.y=f,c.age=r)}c.age++}},t.prototype.fadeIn=function(){var t=this.ctx.globalCompositeOperation;this.ctx.globalCompositeOperation="destination-in",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.globalCompositeOperation=t},t.prototype.drawParticles=function(){var t,e=this.particles;this.fadeIn(),this.ctx.globalAlpha=this.options.globalAlpha,this.ctx.fillStyle="rgba(0, 0, 0, "+this.options.globalAlpha+")",this.ctx.lineWidth=H(this.options.lineWidth)?this.options.lineWidth:1,this.ctx.strokeStyle=null!=(t=this.options.colorScale)&&("string"==typeof t||null!==t.constructor&&t.constructor===String)?this.options.colorScale:"#fff";var n=0,i=e.length;if(this.field&&i>0)for(var r=this.field.range,o=r[0],a=r[1];n<i;n++)this[this.options.useCoordsDraw?"drawCoordsParticle":"drawPixelParticle"](e[n],o,a)},t.prototype.drawPixelParticle=function(t,e,n){var i=[t.x,t.y],r=[t.xt,t.yt];if(r&&i&&Q(r[0])&&Q(r[1])&&Q(i[0])&&Q(i[1])&&t.age<=this.options.maxAge){if(this.ctx.beginPath(),this.ctx.moveTo(i[0],i[1]),this.ctx.lineTo(r[0],r[1]),Y(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(t.m);else if(Array.isArray(this.options.colorScale)){var o=ht(t.m,e,n,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[o]}Y(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(t.m)),t.x=t.xt,t.y=t.yt,this.ctx.stroke()}},t.prototype.drawCoordsParticle=function(t,e,n){var i=[t.x,t.y],r=[t.xt,t.yt];if(r&&i&&Q(r[0])&&Q(r[1])&&Q(i[0])&&Q(i[1])&&this.intersectsCoordinate(r)&&t.age<=this.options.maxAge){var o=this.project(i),a=this.project(r);if(o&&a){if(this.ctx.beginPath(),this.ctx.moveTo(o[0],o[1]),this.ctx.lineTo(a[0],a[1]),t.x=t.xt,t.y=t.yt,Y(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(t.m);else if(Array.isArray(this.options.colorScale)){var s=ht(t.m,e,n,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[s]}Y(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(t.m)),this.ctx.stroke()}}},t.prototype.prepareParticlePaths=function(){var t=this.ctx.canvas,e=t.width,n=t.height,i="function"==typeof this.options.paths?this.options.paths(this):this.options.paths,r=[];if(!this.field)return[];"startBatchInterpolate"in this.field&&this.field.startBatchInterpolate(e,n,this.unproject);for(var o=0;o<i;o++)r.push(this.field.randomize({age:this.randomize()},e,n,this.unproject));return r},t.prototype.randomize=function(){return Math.floor(Math.random()*this.options.maxAge)},t.prototype.project=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];throw new Error("project must be overriden")},t.prototype.unproject=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];throw new Error("unproject must be overriden")},t.prototype.intersectsCoordinate=function(t){throw new Error("must be overriden")},t.prototype.clearCanvas=function(){this.stop(),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.forceStop=!1},t.prototype.start=function(){this.starting=!0,this.forceStop=!1,this._then=Date.now(),this.animate()},t.prototype.stop=function(){cancelAnimationFrame(this.animationLoop),this.starting=!1,this.forceStop=!0},t.prototype.animate=function(){this.animationLoop&&cancelAnimationFrame(this.animationLoop),this.animationLoop=requestAnimationFrame(this.animate);var t=Date.now(),e=t-this._then;e>this.options.frameRate&&(this._then=t-e%this.options.frameRate,this.render())},t.prototype.prerender=function(){this.generated=!1,this.particles=this.prepareParticlePaths(),this.generated=!0,this.starting||this.forceStop||(this.starting=!0,this._then=Date.now(),this.animate())},t.prototype.render=function(){this.moveParticles(),this.drawParticles(),this.postrender()},t.prototype.postrender=function(){},t.Field=et,t}(),pt=0,lt=1;var ft=function(t){function e(e){return t.call(this,e)||this}return U(e,t),e.create=function(t,n){return new e(n)},e.handles=function(t){return"WIND"===t.getType()},e.prototype.prepareFrame=function(t,e){var n=this.getLayer(),i=t.viewHints,r=t.extent;return void 0!==e.extent&&(r=Object(o.B)(r,e.extent)),!this.wind||(!!n.get("forceRender")||!i[pt]&&!i[lt]&&(!(i[pt]||i[lt]||Object(o.H)(r))||!!this.wind))},e.prototype.composeFrame=function(t,e,n){var i=this;this.preCompose(n,t);var r=this.getLayer(),a=t.pixelRatio,s=t.size,c=Math.round(s[0]*a),h=Math.round(s[1]*a),u=e.extent,p=void 0!==u&&!Object(o.g)(u,t.extent)&&Object(o.F)(u,t.extent);p&&void 0!==u&&this.clip(n,t,u);var l=n.globalAlpha;n.globalAlpha=e.opacity,this.innterCanvas&&this.innterCtx?this.innterCanvas.width==c&&this.innterCanvas.height==h||(this.innterCanvas.width=c,this.innterCanvas.height=h):(this.innterCanvas=$(s[0],s[1],a),this.innterCtx=this.innterCanvas.getContext("2d"));var f=r.getWindOptions();if(!this.wind&&this.innterCtx){var d=r.getData();this.wind=new ut(this.innterCtx,f,d),this.wind.project=this.getPixelFromCoordinateInternal.bind(this,t),this.wind.intersectsCoordinate=this.intersectsCoordinate.bind(this,t),this.wind.postrender=function(){n.drawImage(i.innterCanvas,0,0,+i.innterCanvas.width,+i.innterCanvas.height),i.changed()},this.wind.prerender()}if(this.wind){if("generateParticleOption"in f)("function"==typeof f.generateParticleOption?f.generateParticleOption():f.generateParticleOption)&&this.wind.prerender();this.wind.render()}n.globalAlpha=l,p&&n.restore(),this.postCompose(n,t,e)},e.prototype.getPixelFromCoordinateInternal=function(t,e){var n=t.viewState,i=t.pixelRatio,r=Object(p.transform)(e,"EPSG:4326",n.projection);if(t){var o=function(t,e){var n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}(t.coordinateToPixelTransform,r.slice(0,2));return[o[0]*i,o[1]*i]}return null},e.prototype.intersectsCoordinate=function(t,e){var n=t.viewState,i=Object(p.transform)(e,"EPSG:4326",n.projection);return Object(o.f)(t.extent,i.slice(0,2))},e}(v),dt={windOptions:{}},vt=function(t){function e(e,n){var i=this,r=K({},dt,n);return(i=t.call(this,r)||this).field=null,i.options=r,i.type="WIND",i.pickWindOptions(),i._map=r.map||null,e&&i.setData(e),i}return U(e,t),e.prototype.pickWindOptions=function(){var t=this;Object.keys(ct).forEach((function(e){e in t.options&&(void 0===t.options.windOptions&&(t.options.windOptions={}),t.options.windOptions[e]=t.options[e])}))},e.prototype.getData=function(){return this.field},e.prototype.setData=function(t){return t&&t.checkFields&&t.checkFields()?this.field=t:q(t)?this.field=Z(t):console.error("Illegal data"),this},e.prototype.updateParams=function(t){return void 0===t&&(t={}),J("will move to setWindOptions"),this.setWindOptions(t),this},e.prototype.getParams=function(){return J("will move to getWindOptions"),this.getWindOptions()},e.prototype.setWindOptions=function(t){var e=this.options.windOptions||{};this.options=K(this.options,{windOptions:K(e,t||{})})},e.prototype.getWindOptions=function(){return this.options.windOptions||{}},e.prototype.getSourceState=function(){return this.field?"ready":void 0},e.prototype.getType=function(){return this.type},e.prototype.setMap=function(e){t.prototype.setMap.call(this,e)},e}(y),gt={windOptions:{}},yt=function(t){function e(e,n){void 0===n&&(n={});var i=this,r=K({},gt,n);(i=t.call(this,n)||this).options=r,i.wind=null,i.type="IMAGE",i.start=i.start.bind(i),i.stop=i.stop.bind(i),i.pickWindOptions();var o={logo:n.logo,state:n.state,attributions:n.attributions,resolutions:n.resolutions,canvasFunction:i.canvasFunction.bind(i),ratio:n.hasOwnProperty("ratio")?n.ratio:1};return i.setSource(new W(o)),e&&i.setData(e),i}return U(e,t),e.prototype.appendTo=function(t){if(!t)throw new Error("not map object");this.setMap(t)},e.prototype.start=function(){this.wind&&this.wind.start()},e.prototype.stop=function(){this.wind&&this.wind.stop()},e.prototype.canvasFunction=function(t,e,n,i,r){return this.pixelRatio=n,this.canvas?(this.canvas.width=i[0],this.canvas.height=i[1]):this.canvas=$(i[0],i[1],n,null),this.canvas&&this.render(this.canvas),this.canvas},e.prototype.getContext=function(){if(null!==this.canvas)return this.canvas.getContext("2d")},e.prototype.render=function(t){var e=this,n=this.getMap();if(!this.getData()||!n)return this;var i=this.getWindOptions();if(t&&!this.wind){var r=this.getData(),o=this.getContext();o&&(this.wind=new ut(o,i,r),this.wind.project=this.project.bind(this),this.wind.unproject=this.unproject.bind(this),this.wind.intersectsCoordinate=this.intersectsCoordinate.bind(this),this.wind.postrender=function(){e.changed()})}return this.wind&&(this.wind.prerender(),this.wind.render()),this},e.prototype.project=function(t){var e=this.getMap().getPixelFromCoordinate(Object(p.transform)(t,"EPSG:4326",this.viewProjection));return[e[0]*this.pixelRatio,e[1]*this.pixelRatio]},e.prototype.unproject=function(t){var e=this.getMap().getCoordinateFromPixel(t);return Object(p.transform)(e,this.viewProjection,"EPSG:4326")},e.prototype.intersectsCoordinate=function(t){var e=this.getMap();if(!e)return!1;var n=e.getView(),i=e.getSize();if(n&&i){var r=n.calculateExtent([i[0]*this.pixelRatio,i[1]*this.pixelRatio]);return Object(o.f)(r,Object(p.transform)(t,"EPSG:4326",this.viewProjection))}return!1},e.prototype.pickWindOptions=function(){var t=this;Object.keys(ct).forEach((function(e){e in t.options&&(void 0===t.options.windOptions&&(t.options.windOptions={}),t.options.windOptions[e]=t.options[e])}))},e.prototype.getData=function(){return this.field},e.prototype.setData=function(t){return t&&t.checkFields&&t.checkFields()?this.field=t:q(t)?this.field=Z(t):console.error("Illegal data"),this.getMap()&&this.canvas&&this.field&&this.render(this.canvas),this},e.prototype.updateParams=function(t){return void 0===t&&(t={}),J("will move to setWindOptions"),this.setWindOptions(t),this},e.prototype.getParams=function(){return J("will move to getWindOptions"),this.getWindOptions()},e.prototype.setWindOptions=function(t){var e=this.options.windOptions||{};this.options=K(this.options,{windOptions:K(e,t||{})}),this.wind&&(this.wind.setOptions(this.options.windOptions),this.wind.prerender())},e.prototype.getWindOptions=function(){return this.options.windOptions||{}},e.prototype.getProjection=function(){var t=this.getMap();return t?t.getView()&&t.getView().getProjection():"EPSG:3857"},e.prototype.setMap=function(e){return this.set("originMap",e),this.viewProjection=this.getProjection(),t.prototype.setMap.call(this,e)},e.prototype.getMap=function(){return this.get("originMap")},e.prototype.getType=function(){return this.type},e}(y),mt=yt;e.default=yt}}]);